#   Copyright
#
#	Copyright (C) 2011-2012 Jari Aalto
#
#   License
#
#       This program is free software; you can redistribute it and/or modify
#       it under the terms of the GNU General Public License as published by
#       the Free Software Foundation; either version 2 of the License, or
#       (at your option) any later version.
#
#       This program is distributed in the hope that it will be useful,
#       but WITHOUT ANY WARRANTY; without even the implied warranty of
#       MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
#       GNU General Public License for more details.
#
#       You should have received a copy of the GNU General Public License
#       along with this program. If not, see <http://www.gnu.org/licenses/>.
#
#   Description
#
#	To learn what TOP LEVEL sections to use in manual pages,
#	see POSIX/Susv standard and "Utility Description Defaults" at
#	http://www.opengroup.org/onlinepubs/009695399/utilities/xcu_chap01.html#tag_01_11
#
#	This is manual page in Perl POD format. Read more at
#	http://perldoc.perl.org/perlpod.html or run command:
#
#	    perldoc perlpod | less
#
#	To check the syntax:
#
#	    podchecker *.pod
#
#	Create manual page with command:
#
#	    pod2man PAGE.N.pod > PAGE.N

=pod

=head1 NAME

restricted-shell-create - create a restricted shell environment using rbash

=head1 SYNOPSIS

  restricted-shell-create [options] <login name> <list of allowed commands>

=head1 DESCRIPTION

Program to create a restricted shell environment using
C</bin/rbash>. Creates a LOGIN NAME if it does not exist.

Program can only be run by root and it must be run on a host,
that has direct access to the user's home; not on a host that NFS
mounts /home. The allowed commands must be on PATH or written
using full path name.

Remember that the acocunt is only as secure as your choice of
commands. Don't let anyone run commands that would allow escaping
to a shell. Like editors (emacs, vi) or mail programs (mutt) etc.

For a real hard security, remember: "Honestly a restricted shells
are depreciated, you should be using tools such as apparmor,
selinux, grsecurity or virtualization as it is rather trivial to
break out of rbash."

=head1 OPTIONS

=over 4

=item B<-d, --homeroot>

The mount directory of system home. Defaults to /home.

=item B<-D, --debug>

Activate shell debug.

=item B<-f, --force>

Allow destructive changes, like overwriting files while copying
bash startup to user's home directory.

=item B<-g, --group>

If provided, passed to B<usedadd(1)> command if user does not
exist.

=item B<-h, --help>

Display short help.

=item B<-i, --init>

Clean initialization. Delete all previous commands from user's
C<bin/> directory before creating suymlinks to the allowed
commands.

=item B<-o, --chown USER:GROUP>

Set permissions to USER:GROUP. Defaults to root:root.

=item B<-s, --shell PROGRAM>

Set PROGRAM to user's B<--user> shell. Defualts to C</bin/rbash>.

=item B<-t, --test>

Show what commands would be run. Do not actually do anything.

=item B<-v, --verbose>

Be verbose.

=item B<-V, --version>

Display version information.

=back

=head1 EXAMPLES

Create user dummy, allow it to run commands date(1), ls(1) and
ssh(1) but don't actually do anything:

    restricted-shell-create --test dummy date ls ssh

Same, but clean all other command that user may have had access
to from last setup:

    restricted-shell-create --test --init dummy date ls ssh

Overwrite account files while creating the restricted shell
environment:

    restricted-shell-create --force --init dummy date ls ssh

=head1 ENVIRONMENT

None.

=head1 FILES

Directory C</ust/share/restricted-shell-rbash> contains template
field. These are not user editable as they are overwritten by
next install. If you want to supply your own, copy them over to
user directory after this program.

=head1 STANDARDS

None.

=head1 AVAILABILITY

http://freecode.com/projects/restricted-shell-rbash

=head1 SEE ALSO

bash(1)
rbash(1)
ssh(1)

=head1 AUTHORS

Program was written by <jari.aalto@cante.net>

Released under license GNU GPL version 2 or (at your option) any
later version. For more information about license, visit
<http://www.gnu.org/copyleft/gpl.html>.

=cut
